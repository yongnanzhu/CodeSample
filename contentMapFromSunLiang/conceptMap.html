<!DOCTYPE html>
<!--modified from Jam Cellar 2014-05-06-->
<head>
	<meta charset="utf-8">
	<meta name="name" content="Concept Map" />
	<meta name="description" content="An abstract mapping for parameters. Works best if first tag is 'unique' among the tracklist, and the second tag applies to multiple tracks"/>
	<meta name="mintags" content="2" />
	<meta name="maxtags" content="2" />
	<title>Concept Map</title>

<style>

svg {
    font: 12px sans-serif;
}

text {
    pointer-events: none;
}

.inner_node rect {
    pointer-events: all;
}

.inner_node rect.highlight {
    stroke: #315B7E;
    stroke-width: 2px;
}

.outer_node circle {
    fill: #fff;
    stroke: steelblue;
    stroke-width: 1.5px;
    pointer-events: all;
}

.outer_node circle.highlight
{
    stroke: #315B7E;
    stroke-width: 2px;
}

.link {
    fill: none;
}
.rateLimit {
    fill: blue;
}
.normal {
    fill: '#dddddd';
}
</style>	
</head>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
<script type="text/javascript" src="dat.gui.js"></script>
<!--<script src="conceptMapJS/concept_fns.js"></script>-->
<script src="concept_fns.js"></script>
<script>
//
// Generated by the Exaile Playlist Analyzer plugin.
// (C) 2014 Dustin Spicuzza <dustin@virtualroadside.com>
//
// This work is licensed under the Creative Commons Attribution 4.0
// International License. To view a copy of this license, visit
// http://creativecommons.org/licenses/by/4.0/.
//
// Inspired by http://www.findtheconversation.com/concept-map/
// Loosely based on http://bl.ocks.org/mbostock/4063550
//


//var data = [[120, ["like", "call response", "dramatic intro", "has breaks", "male vocalist", "silly", "swing"]], [150, ["brassy", "like", "calm energy", "female vocalist", "swing", "fun"]], [170, ["calm energy", "instrumental", "swing", "like", "happy"]], [140, ["has breaks", "male vocalist", "swing", "piano", "banjo", "chill"]], [160, ["calm energy", "instrumental", "swing", "like", "interesting"]], [140, ["brassy", "like", "energy", "dramatic intro", "male vocalist", "baseball", "swing"]], [170, ["instrumental", "interesting", "high energy", "like", "swing"]], [140, ["instrumental", "energy", "like", "swing"]], [200, ["instrumental", "brassy", "dramatic intro", "like", "swing"]], [160, ["male vocalist", "brassy", "swing", "like", "my favorites"]], [130, ["like", "interesting", "dramatic intro", "male vocalist", "silly", "swing", "gospel"]], [160, ["like", "long intro", "announcer", "energy", "swing", "female vocalist"]], [170, ["instrumental", "swing", "bass", "like"]], [150, ["like", "interesting", "has breaks", "instrumental", "chunky", "swing", "banjo", "trumpet"]], [170, ["like", "has breaks", "male vocalist", "silly", "swing", "banjo"]], [190, ["instrumental", "banjo", "swing"]], [130, ["instrumental", "brassy", "banjo", "like", "swing"]], [160, ["brassy", "like", "energy", "instrumental", "big band", "jam", "swing"]], [150, ["like", "male vocalist", "live", "swing", "piano", "banjo", "chill"]], [150, ["like", "trick ending", "instrumental", "chunky", "swing", "chill"]], [120, ["brassy", "like", "female vocalist", "swing", "chill", "energy buildup"]], [150, ["brassy", "like", "interesting", "instrumental", "swing", "piano"]], [190, ["brassy", "like", "long intro", "energy", "baseball", "swing", "female vocalist"]], [180, ["calm energy", "female vocalist", "live", "like", "swing"]], [200, ["banjo", "like", "long intro", "interesting", "energy", "my favorites", "male vocalist", "silly", "swing", "fun", "balboa"]], [150, ["brassy", "calm energy", "chunky", "instrumental", "old-timey", "live", "swing"]], [160, ["like", "call response", "interesting", "instrumental", "calm energy", "swing"]], [180, ["interesting", "swing", "fast", "male vocalist"]], [150, ["calm energy", "chunky", "swing", "female vocalist", "like"]], [180, ["like", "has breaks", "male vocalist", "chunky", "silly", "swing"]], [140, ["instrumental", "brassy", "dramatic intro", "swing", "chill"]], [150, ["male vocalist", "trumpet", "like", "swing"]], [150, ["instrumental", "energy", "like", "has breaks", "swing"]], [180, ["brassy", "like", "energy", "has breaks", "instrumental", "has calm", "swing"]], [150, ["female vocalist", "swing"]], [170, ["instrumental", "brassy", "energy", "swing"]], [170, ["calm energy", "instrumental", "energy", "like", "swing"]], [190, ["brassy", "like", "instrumental", "high energy", "swing", "trumpet"]], [160, ["male vocalist", "energy", "swing", "old-timey"]], [170, ["like", "oldies", "my favorites", "fast", "male vocalist", "high energy", "swing"]]];
var data=[["O2/CO2 exchange in erythrocytes",["RHAG","CA4","AQP1"]],["Formation of BMAL1:CLOCK/NPAS2 Heterodimer",["NPAS2"]],["mRNA Editing",["A1CF"]],["Phosphorylation and Nuclear Translocation of the BMAL1:CLOCK/NPAS2 Heterodimer",["NPAS2"]],["Abnormal metabolism in phenylketonuria",["PAH"]],["Signaling by VEGF",["NRP1","FIGF"]],["Dissolution of Fibrin Clot",["HRG","PLG"]],["Metabolism of amino acids and derivatives",["PHGDH","NQO1","DDC","IYD","DIO1","PSPH","HAO1","MAT1A","AHCY","CTH","TST","ACAD8","HAL","AMDHD1","AADAT","SLC25A21","PAH","HPD","HGD","FAH","ALDH4A1","KMO","KYNU","HAAO","ASS1","ARG2","SLC25A15","SHMT1","GATM","GAMT","SLC6A11","AGMAT","GLUL","DIO2","CKMT1A","SLC6A7"]],["Reversible Hydration of Carbon Dioxide",["CA6","CA4"]],["Abacavir transport and metabolism",["PCK1","SLC22A2"]],["Stabilization of Unphosphorylated BMAL1:CLOCK/NPAS2 Heterodimer by CRY Proteins",["NPAS2"]],["Formation of Fibrin Clot (Clotting Cascade)",["F7","F2","SERPING1","FGA","FGB","F13B"]],["Gap junction trafficking and regulation",["GJB2","GJB1","GJB6","GJA5","GJA1"]],["Regulation of beta-cell development",["HNF1B","MAFA","SLC2A2","HNF4A","HNF4G","NR5A2"]],["Visual phototransduction",["SDC2","LRP2","RBP1","STRA6","MYO7A","APOA4","APOB","PLB1","GPC5","SDC3","LRP8"]],["Diseases associated with visual transduction",["RBP1","SDC2","LRP2","STRA6","MYO7A","PLB1","APOA4","APOB","GPC5","SDC3","LRP8"]],["Biological oxidations",["CYP1B1","MAT1A","CYP17A1","AHCY","GGT1","HPGDS","CYP1A1","CYP2C18","CYP2W1","CYP3A4","CYP3A7","CYP24A1","ALDH1A1","GSTT1"]],["Scavenging of Heme from Plasma",["HPX","AMBP"]],["Binding of CRY:PER Heterodimer to the BMAL1:CLOCK/NPAS2 Heterodimer",["NPAS2"]],["Regulation of Insulin-like Growth Factor (IGF) Transport and Uptake by Insulin-like Growth Factor Binding Proteins (IGFBPs)",["PLG","F2"]],["SLC-mediated transmembrane transport",["SLC5A8","SLC15A2","SLC5A1","SLC5A9","SLC2A2","SLC37A4","SLC13A2","SLC13A5","SLC39A8","SLC6A11","SLC22A2","RHAG","SLC9A2","SLC22A18","SLC28A3","AVP","SLCO4C1","SLC26A4","SLC4A4","SLC7A7","SLC7A9","SLC3A1","SLC1A1","SLC16A3","SLC6A7","SLC38A4","SLC7A5"]],["Peptide hormone metabolism",["ENPEP","ANPEP","DPP4","CPN1","ACE","ACE2","MME","AGT","CPE"]],["Iron uptake and transport",["ATP6V1G3","ATP6V0D2","ATP6V0A4","STEAP3"]],["Potassium Channels",["KCNJ16","KCNJ15","KCNK2","KCNJ12","KCNJ11","KCNA1","KCNH6","KCNQ3"]],["Latent infection of Homo sapiens with Mycobacterium tuberculosis",["ATP6V0A4","ATP6V0D2","ATP6V1G3"]],["Ion channel transport",["SCNN1A","SGK2","CLCNKB","MCOLN2","ATP8B1","ATP8A2","GABRA4","GLRA2","CLCN4","BEST3","RYR2","ATP7B","ATP2B2"]],["Cell junction organization",["CLDN10","CLDN1","CLDN2","CLDN3","CLDN4","LAMB3","CDH8"]],["Cell surface interactions at the vascular wall",["SLC7A7","SLC7A9","AMICA1","F2","APOB","GRB14","SLC16A3","SLC7A5"]],["Fanconi Anemia pathway",["FANCI","BRCA2"]],["BMAL1:CLOCK/NPAS2 Activates Circadian Expression",["AVP","F7","NPAS2"]],["Platelet activation, signaling and aggregation",["RASGRP1","FGB","FGA","CRK","PLG","HRG","SERPING1","FIGF","GNA14","F2","PIK3R5","DGKH","TGFB3","CD36"]],["Striated Muscle Contraction",["MYL1","MYL3"]],["Transmission across Chemical Synapses",["GABRA4","SLC22A2","KCNJ16","KCNJ15","SLC1A1","SLC18A3","SLC6A11","CAMK2A","CACNB2","GRIN2A","GRIK1","KCNJ12","GLUL","CHRNA1"]],["Metabolism of vitamins and cofactors",["SHMT1","AMN","CYB5A","ACACB","NMNAT2","SLC23A2"]],["Metabolism of nucleotides",["XDH","UPP1","CDA","DPYD","DPYS"]],["Platelet homeostasis",["PDE1A","APOB","GUCY1A3","ATP2B2","LRP8"]],["Metabolism of lipids and lipoproteins",["APOB","MTTP","DGAT2","ACACB","APOA4","HMGCS2","CYP1A1","SLC27A2","BAAT","CYP17A1","HSD3B2","HSD11B1","LRP2","CYP24A1","PLB1","TPTE2","AMN","PTGES","CBR1","HPGDS","GGT1","DPEP1","CYP1B1","AGT","CD36","G0S2","NPAS2","IDI1","SQLE","SRD5A2","ETNK2","PIK3R5"]],["Amyloids",["APOA4","FGA"]],["Metabolism of carbohydrates",["PCK1","GYS2","SLC5A1","SLC5A9","SLC2A2","SDC2","HS3ST6","SLC37A4","MGAM","ALDOB","GPC5","SDC3","NDST4","HS3ST5"]],["Signaling by GPCR",["AVP","AVPR1A","F2","F2RL1","C5","RXFP2","RXFP3","ADRA1B","MTNR1B","PTH1R","PTCH1","FZD10","GPRC6A","PDE1A","GNA14","CCL19","RASGRP1","XCR1","NET1","OR52B2","PDE4B","TACR1","NTSR1","AGT","FZD3","PENK","RGS6","DGKH","NGEF","PIK3R5"]],["Integration of energy metabolism",["ACACB","GNA14","SLC2A2","CACNA1C","CACNB2","KCNJ11"]],["Signaling by Insulin receptor",["PRKAG3","CRK","ATP6V1G3","ATP6V0D2","ATP6V0A4","KL","FGF1"]],["Integrin cell surface interactions",["COL4A4","SPP1","FGB","FGA"]],["Metabolism of nitric oxide",["SPR"]],["Elastic fibre formation",["FBLN1","TGFB3"]],["Aquaporin-mediated transport",["AVP","AQP1"]],["Axon guidance",["COL4A4","CACNA1I","NRP1","CRMP1","ST8SIA2","CACNA1C","CACNB2","UNC5A","UNC5D","PAK3","CAP2","KCNQ3"]],["Expression of NPAS2",["NPAS2"]],["Signaling by PDGF",["SPP1","KL","ERBB3","EREG","PLG","PDE1A","COL4A4","CRK","FGF1"]],["Nephrin interactions",["KIRREL3"]],["Mucopolysaccharidoses",["SDC2","HS3ST6","GPC5","SDC3","NDST4","HS3ST5"]],["Post-translational protein modification",["F2","F7","GALNT14","GALNT6","GCNT4","PIGN","ST8SIA2"]],["Double-Strand Break Repair",["BRCA2"]],["PI3K/AKT Signaling in Cancer",["KL","ERBB3","EREG","FGF1"]],["RORA Activates Circadian Expression",["NPAS2"]],["Signaling by NOTCH1 in Cancer",["HES5","DNER","DLK1"]],["Translocation of GLUT4 to the Plasma Membrane",["SFN","PRKAG3"]],["Meiotic Recombination",["BRCA2"]],["Collagen formation",["COL22A1","COL4A4","LAMB3"]],["PIP3 activates AKT signaling",["KL","ERBB3","EREG","FGF1"]],["Circadian Repression of Expression by REV-ERBA",["NPAS2"]],["DAG and IP3 signaling",["PDE1A"]],["Degradation of the extracellular matrix",["PLG","SPP1","LAMB3"]],["Signaling by Rho GTPases",["RHOBTB1","NET1","ARHGAP44","NGEF"]],["ABC-family proteins mediated transport",["ABCC2"]],["Signaling by FGFR in disease",["PDE1A","ERBB3","EREG","KL","FGF1"]],["Signaling by ERBB4",["ERBB3","EREG","KL","FGF1"]],["Signaling by SCF-KIT",["KL","ERBB3","EREG","FGF1"]],["Signalling by NGF",["CRK","PDE1A","KL","ERBB3","EREG","NET1","FGF1","NGEF"]],["Signaling by EGFR in Cancer",["KL","ERBB3","EREG","PDE1A","FGF1"]],["Signaling by NOTCH",["HES5","DNER","DLK1"]],["Meiotic Synapsis",["FKBP6"]],["Transcriptional Regulation of White Adipocyte Differentiation",["PCK1","CD36"]],["Signaling by Type 1 Insulin-like Growth Factor 1 Receptor (IGF1R)",["KL","PRKAG3","FGF1"]],["Innate Immune System",["KL","ERBB3","EREG","PDE1A","RASGRP1","SIGIRR","MASP1","C5","C6","CRK","FGF1","SARM1","CD36"]],["Factors involved in megakaryocyte development and platelet production",["KIF9","GATA3","ZFPM2"]],["Signaling by FGFR",["PDE1A","ERBB3","EREG","KL","FGF1"]],["Adaptive Immune System",["CD8B","CTLA4","CRTAM","AMICA1","SRMS","RASGRP1","KL","ERBB3","EREG","TRIM36","ASB9","CD36","DYNC1I1","FGF1"]],["Generic Transcription Pathway",["ESR2","HNF4A","HNF4G","NR1H4","NR5A2"]],["Signaling by EGFR",["KL","ERBB3","EREG","PDE1A","FGF1"]],["Intrinsic Pathway for Apoptosis",["SFN"]],["Signaling by ERBB2",["EREG","PDE1A","ERBB3","KL","FGF1"]],["Apoptotic execution  phase",["OCLN"]],["Cytokine Signaling in Immune system",["IRF6","XAF1","IL1B","CRK","CAMK2A"]],["Regulation of Apoptosis",["UNC5A"]],["Chromosome Maintenance",["FKBP6","TERT"]],["The citric acid (TCA) cycle and respiratory electron transport",["SUCLG2","ADHFE1","SLC16A3"]],["Nonsense-Mediated Decay",["RPL27A"]],["HIV Infection",["CD8B","GTF2E2"]],["Influenza Infection",["RPL27A"]],["Translation",["RPL27A"]],["RNA Polymerase II Transcription",["GTF2E2"]],["Unfolded Protein Response",["TPP1"]]];
//<?php
//    $jsonFile = $_GET['fileName'];
//    $jsonData = file_get_contents($jsonFile);
//
//?>
//var data = <?php echo $jsonData; ?>;
//console.log(data);

// transform the data into a useful representation
// 1 is inner, 2, is outer

// need: inner, outer, links
//
// inner: 
// links: { inner: outer: }

function compare(a,b) {
  if (a.name.length > b.name.length)
     return -1;
  if (a.name.length < b.name.length)
    return 1;
  return 0;
}


var outer = d3.map();
var inner = [];
var links = [];

var outerId = [0];

data.forEach(function(d){
	
	if (d == null)
		return;
	
	i = { id: 'i' + inner.length, name: d[0], related_links: [] };  //to do, we can sort the inner array
	i.related_nodes = [i.id];
	inner.push(i);
	
	if (!Array.isArray(d[1]))
		d[1] = [d[1]];
	
	d[1].forEach(function(d1){
		
		o = outer.get(d1);
		
		if (o == null)
		{
			o = { name: d1,	id: 'o' + outerId[0], related_links: [] };
			o.related_nodes = [o.id];
			outerId[0] = outerId[0] + 1;	
			
			outer.set(d1, o);
		}
		
		// create the links
		l = { id: 'l-' + i.id + '-' + o.id, inner: i, outer: o }
		links.push(l);
		
		// and the relationships
		i.related_nodes.push(o.id);
		i.related_links.push(l.id);
		o.related_nodes.push(i.id);
		o.related_links.push(l.id);
	});
});

inner = inner.sort(compare);
var inner_even = [];
var inner_odd = [];
for(var i=0;i<inner.length; i++){
    if(i%2){
	inner_odd.push(inner[i]);
    }else{
	inner_even.push(inner[i]);
    }
}

inner =inner_odd.reverse().concat(inner_even);

data = {
	inner: inner,     //{ id: 'i' + inner.length, name: d[0], related_links: [] };
	outer: outer.values(),   //only the value part { name: d1,	id: 'o' + outerId[0], related_links: [] };
	links: links
}



//console.log('before the function:');
//var temp_out = data;
//console.log(temp_out);    
   
// need to specify x/y/etc
window.gui_flag = false;
window._data = null;
//var b = a 
loadData(data);



//svg.on("click",function(){
//    console.log('I am here');
//    //loadData(svg,diagonal,data);
//    
//}); //link gray (array)


</script>

